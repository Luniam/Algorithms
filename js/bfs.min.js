$(document).ready(startfn);
function startfn(){function h(a){$("#play").removeClass();$("#play").addClass("glyphicon glyphicon-"+a+" playpause")}function I(){q=+$("#sourceInput").val();C();if(q>b.V()-1||0>q){var a=b.V()-1;alert("please select a source between 0 and "+a)}else{r&&(ui.output.resetGraph(b),r=!1);g=1;h("pause");for(a=0;a<b.V();a++)a!==q&&(b.colors[a]="WHITE",b.d[a]=-1,b.parents[a]=-1);b.colors[q]="GRAY";b.d[q]=0;b.parents[q]=0;y.enqueue(q)}for(l=0;0<y.size();){a=y.dequeue();l++;var f={};f[a]=[];for(var c=b.getAdj(a),
d=0;d<c.length;d++){var e=c[d];"WHITE"===b.colors[e]&&(l++,f[a].push(e),b.colors[e]="GRAY",b.d[e]=b.d[a]+1,b.parents[e]=a,y.enqueue(e))}n.push(f);"BLACK"===b.colors[a]}console.log(n);0!=l&&(t=100/l);p++}function E(){if(e>=n.length)g=3,h("repeat");else{var a=Object.keys(n[e])[0],f="#vertex"+a,a="#text"+a,d={},v=[];v.push(f);v.push(a);d.vertex=v;m.push(d);c=ui.output.getSpeedInMilliseconds("#speedbar");d3.select(f).transition().style({fill:"#F38630",stroke:"#F38630"}).duration(c);d3.select(a).transition().style({fill:"rgb(255, 255, 255)"}).duration(c);
k="edge";ui.output.changeProgressBar("#progressbar",t);e==b.V()-1&&(g=3,h("repeat"))}}function J(){var a=Object.keys(n[e])[0],f=n[e][a];if(0==f.length){k="vertex";w.push(d);d=0;e++;var a={},u=[];a.edgeTurn=u;m.push(a);E();if(e==b.V()){g=3;h("repeat");return}}else if(d>=f.length){if(k="vertex",d=0,e++,e==b.V()){g=3;h("repeat");return}}else{var v="#vertex"+f[d],z="#edge",z=parseInt(a)<f[d]?z+a+f[d]:z+f[d]+a,a={},u=[];u.push(v);u.push(z);a.edge=u;m.push(a);c=ui.output.getSpeedInMilliseconds("#speedbar");
d3.select(z).transition().style({stroke:"rgb(0, 128, 0)","stroke-width":5}).duration(c);d3.select(v).transition().style({fill:"#808080",stroke:"#808080"}).delay(50).duration(c);d++;if(d>=f.length&&(k="vertex",w.push(d),d=0,e++,a={},u=[],a.edgeTurn2=u,m.push(a),e==b.V())){g=3;h("repeat");return}ui.output.changeProgressBar("#progressbar",t)}e==b.V()&&(g=3,h("repeat"))}function A(a){r=!0;e<=b.V()-1&&1===g&&a==p?"vertex"==k?(E(),c=ui.output.getSpeedInMilliseconds("#speedbar"),setTimeout(function(){A(a)},
c)):"edge"==k&&(J(),c=ui.output.getSpeedInMilliseconds("#speedbar"),setTimeout(function(){A(a)},c)):e==b.V()&&(g=3,h("repeat"))}function K(){if(0<m.length&&0===g){var a=m.pop(),f=Object.keys(a)[0];"vertex"==f?(f=a.vertex[0],a=a.vertex[1],c=ui.output.getSpeedInMilliseconds("#speedbar"),d3.select(f).transition().style({fill:"#808080",stroke:"#808080"}).duration(c),d3.select(a).transition().style({fill:"#000000"}).duration(c),k="vertex",a=-1*t,ui.output.changeProgressBar("#progressbar",a),a=m[m.length-
1],a=Object.keys(a)[0],"edgeTurn"==a&&(k="edge",e--,d=w.pop(),m.pop())):"edge"==f?(f=a.edge[0],a=a.edge[1],c=ui.output.getSpeedInMilliseconds("#speedbar"),d3.select(f).transition().style({fill:"#FFFFFF",stroke:"#C61C6F"}).delay(50).duration(c),d3.select(a).transition().style({stroke:"#000000","stroke-width":2}).duration(c),d--,a=-1*t,ui.output.changeProgressBar("#progressbar",a)):"edgeTurn2"==f&&(k="edge",e--,d=w.pop(),a=m[m.length-1],a=Object.keys(a)[0],"edge"==a&&K())}}function Q(){for(var a=l=
0;a<b.V();a++)b.colors[a]="WHITE",b.parents[a]=-1;for(a=F=0;a<b.V();a++)"WHITE"===b.colors[a]&&L(a);console.log(n);0!=l&&(t=100/l)}function L(a){F++;var f={};f[a]=[];l++;b.colors[a]="GRAY";for(var c=b.getAdj(a),d=0;d<c.length;d++){var e=c[d];"WHITE"===b.colors[e]&&(b.parents[e]=a,f[a].push(e),n.push(f),l++,f={},f[a]=[],L(e))}n.push(f);b.colors[a]="BLACK";F++}function M(){p++;C();x="DFS";r&&(ui.output.resetGraph(b),r=!1);g=1;h("pause");Q();c=ui.output.getSpeedInMilliseconds("#speedbar");setTimeout(function(){D(p)},
c)}function D(a){r=!0;1===g&&a==p&&("vertex"==k?(R(),c=ui.output.getSpeedInMilliseconds("#speedbar"),setTimeout(function(){D(a)},c)):"edge"==k&&(S(),c=ui.output.getSpeedInMilliseconds("#speedbar"),setTimeout(function(){D(a)},c)))}function R(){if(e>=n.length)g=3,h("repeat");else{var a=Object.keys(n[e])[0],f="#vertex"+a,b="#text"+a,a={},d=[];d.push(f);d.push(b);a.vertex=d;m.push(a);c=ui.output.getSpeedInMilliseconds("#speedbar");d3.select(f).transition().style({fill:"#808080",stroke:"#FF1919"}).duration(c);
d3.select(b).transition().style({fill:"rgb(255, 255, 255)"}).duration(c);setTimeout(function(){d3.select(f).transition().style({fill:"#808080",stroke:"#808080"}).duration(c);d3.select(b).transition().style({fill:"rgb(0, 0, 0)"}).duration(c)},c);k="edge";ui.output.changeProgressBar("#progressbar",t)}}function S(){var a=Object.keys(n[e])[0],b=n[e][a];if(0==b.length){k="vertex";w.push(d);d=0;e++;var g={},h=[];g.edgeTurn=h;m.push(g);b="#text"+a;d3.select("#vertex"+a).transition().style({fill:"#F38630",
stroke:"#F38630"}).duration(c);d3.select(b).transition().style({fill:"rgb(255, 255, 255)"}).duration(c)}else{var p="#vertex"+b[d],l="#edge",l=parseInt(a)<b[d]?l+a+b[d]:l+b[d]+a,g={},h=[];h.push(p);h.push(l);g.edge=h;m.push(g);c=ui.output.getSpeedInMilliseconds("#speedbar");d3.select(l).transition().style({stroke:"rgb(0, 128, 0)","stroke-width":5}).duration(c);d3.select(p).transition().style({fill:"#808080",stroke:"#808080"}).delay(50).duration(c);d++;d>=b.length&&(k="vertex",w.push(d),d=0,e++,g={},
h=[],g.edgeTurn2=h,m.push(g));ui.output.changeProgressBar("#progressbar",t)}}function C(){k="vertex";d=e=0;y=new Queue;m=[];n=[];ui.output.drawProgressBar("#progressbar")}function G(a){$("#mainSVG").remove();ui.output.redrawGraph(H[0],"#viz",a);b=ui.output.graph();H=ui.output.graphNodes();C();g=2;h("play");r=!1;p=0;N()}function O(){"none"==$("#slide").css("display")?$(".thirdelem").css("padding-top","90px"):$(".thirdelem").css("padding-top","45px")}function P(){$("#slide").toggle("slide");setTimeout(function(){O()},
500)}function N(){O();$("#slide3").toggle("slide")}var l=0,t=0,r=!1,g=2,k="vertex",e=0,d=0,w=[],y=new Queue,m=[],n=[],p=0,c=500,B=0,F=0,x="BFS";ui.output.pageLoad("#viz","#speedbar","#progressbar");var q=0,H=ui.output.graphNodes(),b=ui.output.graph();$("#play").on("click",function(){0===g?(g=1,h("pause"),"BFS"===x?A(p):"DFS"===x&&D(p)):1===g?(g=0,h("play")):3===g?"BFS"===x?(I(),g=1,h("pause"),c=ui.output.getSpeedInMilliseconds("#speedbar"),setTimeout(function(){A(p)},c)):"DFS"===x&&(M(),g=1,h("pause")):
alert("Please choose BFS or DFS from the left hand side menu.")});$("#forward").on("click",function(){e<=b.V()-1&&0===g&&("vertex"==k?E():"edge"==k&&J())});$("#backward").on("click",K);$("#runBFS").on("click",P);$("#runDFS").on("click",M);$("#startBFS").on("click",function(){P();x="BFS";I();c=ui.output.getSpeedInMilliseconds("#speedbar");setTimeout(function(){A(p)},c)});$("#samples").on("click",N);$("#graph1").on("click",function(){G(1)});$("#graph2").on("click",function(){G(2)});$("#graph3").on("click",
function(){G(3)});d3.select("#drawPanel").on("mousedown",function(){d3.event.defaultPrevented||ui.output.drawVertexOnClick(this,B++)});$("#draw").on("click",function(){ui.output.resetDrawPanel();B=0});$("#doneButton").on("click",function(){0!=B&&($("#mainSVG").remove(),ui.output.drawUserGraph(B,"#viz"),b=ui.output.graph(),H=ui.output.graphNodes(),C(),g=2,h("play"),r=!1,p=0)});$("#restartButton").on("click",function(){ui.output.resetDrawPanel();B=0})};
