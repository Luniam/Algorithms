$(document).ready(startfn);
function startfn(){function h(a){$("#play").removeClass();$("#play").addClass("glyphicon glyphicon-"+a+" playpause")}function I(){q=+$("#sourceInput").val();C();if(q>b.V()-1||0>q){var a=b.V()-1;alert("please select a source between 0 and "+a)}else{r&&(ui.output.resetGraph(b),r=!1);f=1;h("pause");for(a=0;a<b.V();a++)a!==q&&(b.colors[a]="WHITE",b.d[a]=-1,b.parents[a]=-1);b.colors[q]="GRAY";b.d[q]=0;b.parents[q]=0;y.enqueue(q)}for(n=0;0<y.size();){a=y.dequeue();n++;var g={};g[a]=[];for(var c=b.getAdj(a),
d=0;d<c.length;d++){var e=c[d];"WHITE"===b.colors[e]&&(n++,g[a].push(e),b.colors[e]="GRAY",b.d[e]=b.d[a]+1,b.parents[e]=a,y.enqueue(e))}p.push(g);"BLACK"===b.colors[a]}0!=n&&(t=100/n);l++}function E(){if(e>=p.length)f=3,h("repeat");else{var a=Object.keys(p[e])[0],g="#vertex"+a,a="#text"+a,d={},w=[];w.push(g);w.push(a);d.vertex=w;m.push(d);c=ui.output.getSpeedInMilliseconds("#speedbar");d3.select(g).transition().style({fill:"#F38630",stroke:"#F38630"}).duration(c);d3.select(a).transition().style({fill:"rgb(255, 255, 255)"}).duration(c);
k="edge";ui.output.changeProgressBar("#progressbar",t);e==b.V()-1&&(f=3,h("repeat"))}}function J(){var a=Object.keys(p[e])[0],g=p[e][a];if(0==g.length){k="vertex";x.push(d);d=0;e++;var a={},v=[];a.edgeTurn=v;m.push(a);E();if(e==b.V()){f=3;h("repeat");return}}else if(d>=g.length){if(k="vertex",d=0,e++,e==b.V()){f=3;h("repeat");return}}else{var w="#vertex"+g[d],z="#edge",z=parseInt(a)<g[d]?z+a+g[d]:z+g[d]+a,a={},v=[];v.push(w);v.push(z);a.edge=v;m.push(a);c=ui.output.getSpeedInMilliseconds("#speedbar");
d3.select(z).transition().style({stroke:"rgb(0, 128, 0)","stroke-width":5}).duration(c);d3.select(w).transition().style({fill:"#808080",stroke:"#808080"}).delay(50).duration(c);d++;if(d>=g.length&&(k="vertex",x.push(d),d=0,e++,a={},v=[],a.edgeTurn2=v,m.push(a),e==b.V())){f=3;h("repeat");return}ui.output.changeProgressBar("#progressbar",t)}e==b.V()&&(f=3,h("repeat"))}function A(a){r=!0;e<=b.V()-1&&1===f&&a==l?"vertex"==k?(E(),c=ui.output.getSpeedInMilliseconds("#speedbar"),setTimeout(function(){A(a)},
c)):"edge"==k&&(J(),c=ui.output.getSpeedInMilliseconds("#speedbar"),setTimeout(function(){A(a)},c)):e==b.V()&&(f=3,h("repeat"))}function K(){if(0<m.length&&0===f){var a=m.pop(),g=Object.keys(a)[0];"vertex"==g?(g=a.vertex[0],a=a.vertex[1],c=ui.output.getSpeedInMilliseconds("#speedbar"),d3.select(g).transition().style({fill:"#808080",stroke:"#808080"}).duration(c),d3.select(a).transition().style({fill:"#000000"}).duration(c),k="vertex",a=-1*t,ui.output.changeProgressBar("#progressbar",a),a=m[m.length-
1],a=Object.keys(a)[0],"edgeTurn"==a&&(k="edge",e--,d=x.pop(),m.pop())):"edge"==g?(g=a.edge[0],a=a.edge[1],c=ui.output.getSpeedInMilliseconds("#speedbar"),d3.select(g).transition().style({fill:"#FFFFFF",stroke:"#C61C6F"}).delay(50).duration(c),d3.select(a).transition().style({stroke:"#000000","stroke-width":2}).duration(c),d--,a=-1*t,ui.output.changeProgressBar("#progressbar",a)):"edgeTurn2"==g&&(k="edge",e--,d=x.pop(),a=m[m.length-1],a=Object.keys(a)[0],"edge"==a&&K())}}function S(){for(var a=n=
0;a<b.V();a++)b.colors[a]="WHITE",b.parents[a]=-1;for(a=F=0;a<b.V();a++)"WHITE"===b.colors[a]&&L(a);0!=n&&(t=100/n)}function L(a){F++;var g={};g[a]=[];b.colors[a]="GRAY";for(var c=b.getAdj(a),d=0;d<c.length;d++){var e=c[d];"WHITE"===b.colors[e]&&(b.parents[e]=a,g[a].push(e),p.push(g),n+=2,g={},g[a]=[],L(e))}p.push(g);n++;b.colors[a]="BLACK";F++}function M(){l++;C();u="DFS";r&&(ui.output.resetGraph(b),r=!1);f=1;h("pause");S();c=ui.output.getSpeedInMilliseconds("#speedbar");setTimeout(function(){D(l)},
c)}function D(a){r=!0;1===f&&a==l&&("vertex"==k?(N(),c=ui.output.getSpeedInMilliseconds("#speedbar"),setTimeout(function(){D(a)},c)):"edge"==k&&(O(),c=ui.output.getSpeedInMilliseconds("#speedbar"),setTimeout(function(){D(a)},c)))}function N(){if(e>=p.length)f=3,h("repeat");else{var a=Object.keys(p[e])[0],g="#vertex"+a,b="#text"+a,a={},d=[];d.push(g);d.push(b);a.vertex=d;m.push(a);c=ui.output.getSpeedInMilliseconds("#speedbar");d3.select(g).transition().style({fill:"#808080",stroke:"#FF1919"}).duration(c);
d3.select(b).transition().style({fill:"rgb(255, 255, 255)"}).duration(c);setTimeout(function(){d3.select(g).transition().style({fill:"#808080",stroke:"#808080"}).duration(c);d3.select(b).transition().style({fill:"rgb(0, 0, 0)"}).duration(c)},c);k="edge";ui.output.changeProgressBar("#progressbar",t)}}function O(){var a=Object.keys(p[e])[0],b=p[e][a];if(0==b.length){k="vertex";x.push(d);d=0;e++;var f={},h=[];f.edgeTurn=h;m.push(f);b="#text"+a;d3.select("#vertex"+a).transition().style({fill:"#F38630",
stroke:"#F38630"}).duration(c);d3.select(b).transition().style({fill:"rgb(255, 255, 255)"}).duration(c)}else{var n="#vertex"+b[d],l="#edge",l=parseInt(a)<b[d]?l+a+b[d]:l+b[d]+a,f={},h=[];h.push(n);h.push(l);f.edge=h;m.push(f);c=ui.output.getSpeedInMilliseconds("#speedbar");d3.select(l).transition().style({stroke:"rgb(0, 128, 0)","stroke-width":5}).duration(c);d3.select(n).transition().style({fill:"#808080",stroke:"#808080"}).delay(50).duration(c);d++;d>=b.length&&(k="vertex",x.push(d),d=0,e++,f={},
h=[],f.edgeTurn2=h,m.push(f));ui.output.changeProgressBar("#progressbar",t)}}function C(){k="vertex";d=e=0;y=new Queue;m=[];p=[];ui.output.drawProgressBar("#progressbar")}function G(a){$("#mainSVG").remove();ui.output.redrawGraph(H[0],"#viz",a);b=ui.output.graph();H=ui.output.graphNodes();C();f=2;h("play");r=!1;l=0;P()}function Q(){"none"==$("#slide").css("display")?$(".thirdelem").css("padding-top","90px"):$(".thirdelem").css("padding-top","45px")}function R(){$("#slide").toggle("slide");setTimeout(function(){Q()},
500)}function P(){Q();$("#slide3").toggle("slide")}var n=0,t=0,r=!1,f=2,k="vertex",e=0,d=0,x=[],y=new Queue,m=[],p=[],l=0,c=500,B=0,F=0,u="BFS";ui.output.pageLoad("#viz","#speedbar","#progressbar");var q=0,H=ui.output.graphNodes(),b=ui.output.graph();$("#play").on("click",function(){0===f?(f=1,h("pause"),"BFS"===u?A(l):"DFS"===u&&D(l)):1===f?(f=0,h("play")):3===f?"BFS"===u?(I(),f=1,h("pause"),c=ui.output.getSpeedInMilliseconds("#speedbar"),setTimeout(function(){A(l)},c)):"DFS"===u&&(M(),f=1,h("pause")):
alert("Please choose BFS or DFS from the left hand side menu.")});$("#forward").on("click",function(){"BFS"===u?e<=b.V()-1&&0===f&&("vertex"==k?E():"edge"==k&&J()):"DFS"===u&&0===f&&("vertex"===k?N():"edge"===k&&O())});$("#backward").on("click",K);$("#runBFS").on("click",R);$("#runDFS").on("click",M);$("#startBFS").on("click",function(){R();u="BFS";I();c=ui.output.getSpeedInMilliseconds("#speedbar");setTimeout(function(){A(l)},c)});$("#samples").on("click",P);$("#graph1").on("click",function(){G(1)});
$("#graph2").on("click",function(){G(2)});$("#graph3").on("click",function(){G(3)});d3.select("#drawPanel").on("mousedown",function(){d3.event.defaultPrevented||ui.output.drawVertexOnClick(this,B++)});$("#draw").on("click",function(){ui.output.resetDrawPanel();B=0});$("#doneButton").on("click",function(){0!=B&&($("#mainSVG").remove(),ui.output.drawUserGraph(B,"#viz"),b=ui.output.graph(),H=ui.output.graphNodes(),C(),f=2,h("play"),r=!1,l=0)});$("#restartButton").on("click",function(){ui.output.resetDrawPanel();
B=0})};
